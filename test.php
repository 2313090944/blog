<?php
$key = "847404572a";
$content = '{"ref":"refs/heads/master","before":"fecbe7f95f88ec579b3cb7e53baa8eefd0a38b69","after":"a1f074b9f532387fe1e8bdab45c5c54b40306889","created":false,"deleted":false,"forced":false,"base_ref":null,"compare":"https://github.com/ITHcc/blog/compare/fecbe7f95f88...a1f074b9f532","commits":[{"id":"a1f074b9f532387fe1e8bdab45c5c54b40306889","tree_id":"2e865b7e3ac72d0e9f9a2c1f85b8c3ebdec69e9d","distinct":true,"message":"\'test\'","timestamp":"2018-11-30T20:06:56+08:00","url":"https://github.com/ITHcc/blog/commit/a1f074b9f532387fe1e8bdab45c5c54b40306889","author":{"name":"怀闯","email":"847404572@qq.com","username":"ITHcc"},"committer":{"name":"怀闯","email":"847404572@qq.com","username":"ITHcc"},"added":[],"removed":[],"modified":["test.php"]}],"head_commit":{"id":"a1f074b9f532387fe1e8bdab45c5c54b40306889","tree_id":"2e865b7e3ac72d0e9f9a2c1f85b8c3ebdec69e9d","distinct":true,"message":"\'test\'","timestamp":"2018-11-30T20:06:56+08:00","url":"https://github.com/ITHcc/blog/commit/a1f074b9f532387fe1e8bdab45c5c54b40306889","author":{"name":"怀闯","email":"847404572@qq.com","username":"ITHcc"},"committer":{"name":"怀闯","email":"847404572@qq.com","username":"ITHcc"},"added":[],"removed":[],"modified":["test.php"]},"repository":{"id":158551885,"node_id":"MDEwOlJlcG9zaXRvcnkxNTg1NTE4ODU=","name":"blog","full_name":"ITHcc/blog","private":false,"owner":{"name":"ITHcc","email":"37447321+ITHcc@users.noreply.github.com","login":"ITHcc","id":37447321,"node_id":"MDQ6VXNlcjM3NDQ3MzIx","avatar_url":"https://avatars2.githubusercontent.com/u/37447321?v=4","gravatar_id":"","url":"https://api.github.com/users/ITHcc","html_url":"https://github.com/ITHcc","followers_url":"https://api.github.com/users/ITHcc/followers","following_url":"https://api.github.com/users/ITHcc/following{/other_user}","gists_url":"https://api.github.com/users/ITHcc/gists{/gist_id}","starred_url":"https://api.github.com/users/ITHcc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ITHcc/subscriptions","organizations_url":"https://api.github.com/users/ITHcc/orgs","repos_url":"https://api.github.com/users/ITHcc/repos","events_url":"https://api.github.com/users/ITHcc/events{/privacy}","received_events_url":"https://api.github.com/users/ITHcc/received_events","type":"User","site_admin":false},"html_url":"https://github.com/ITHcc/blog","description":"一个基于vue全家桶开发的的个人博客","fork":false,"url":"https://github.com/ITHcc/blog","forks_url":"https://api.github.com/repos/ITHcc/blog/forks","keys_url":"https://api.github.com/repos/ITHcc/blog/keys{/key_id}","collaborators_url":"https://api.github.com/repos/ITHcc/blog/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/ITHcc/blog/teams","hooks_url":"https://api.github.com/repos/ITHcc/blog/hooks","issue_events_url":"https://api.github.com/repos/ITHcc/blog/issues/events{/number}","events_url":"https://api.github.com/repos/ITHcc/blog/events","assignees_url":"https://api.github.com/repos/ITHcc/blog/assignees{/user}","branches_url":"https://api.github.com/repos/ITHcc/blog/branches{/branch}","tags_url":"https://api.github.com/repos/ITHcc/blog/tags","blobs_url":"https://api.github.com/repos/ITHcc/blog/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/ITHcc/blog/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/ITHcc/blog/git/refs{/sha}","trees_url":"https://api.github.com/repos/ITHcc/blog/git/trees{/sha}","statuses_url":"https://api.github.com/repos/ITHcc/blog/statuses/{sha}","languages_url":"https://api.github.com/repos/ITHcc/blog/languages","stargazers_url":"https://api.github.com/repos/ITHcc/blog/stargazers","contributors_url":"https://api.github.com/repos/ITHcc/blog/contributors","subscribers_url":"https://api.github.com/repos/ITHcc/blog/subscribers","subscription_url":"https://api.github.com/repos/ITHcc/blog/subscription","commits_url":"https://api.github.com/repos/ITHcc/blog/commits{/sha}","git_commits_url":"https://api.github.com/repos/ITHcc/blog/git/commits{/sha}","comments_url":"https://api.github.com/repos/ITHcc/blog/comments{/number}","issue_comment_url":"https://api.github.com/repos/ITHcc/blog/issues/comments{/number}","contents_url":"https://api.github.com/repos/ITHcc/blog/contents/{+path}","compare_url":"https://api.github.com/repos/ITHcc/blog/compare/{base}...{head}","merges_url":"https://api.github.com/repos/ITHcc/blog/merges","archive_url":"https://api.github.com/repos/ITHcc/blog/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/ITHcc/blog/downloads","issues_url":"https://api.github.com/repos/ITHcc/blog/issues{/number}","pulls_url":"https://api.github.com/repos/ITHcc/blog/pulls{/number}","milestones_url":"https://api.github.com/repos/ITHcc/blog/milestones{/number}","notifications_url":"https://api.github.com/repos/ITHcc/blog/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/ITHcc/blog/labels{/name}","releases_url":"https://api.github.com/repos/ITHcc/blog/releases{/id}","deployments_url":"https://api.github.com/repos/ITHcc/blog/deployments","created_at":1542806794,"updated_at":"2018-11-30T12:04:55Z","pushed_at":1543579623,"git_url":"git://github.com/ITHcc/blog.git","ssh_url":"git@github.com:ITHcc/blog.git","clone_url":"https://github.com/ITHcc/blog.git","svn_url":"https://github.com/ITHcc/blog","homepage":"http://blog.52qy.top/","size":22656,"stargazers_count":2,"watchers_count":2,"language":"HTML","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":3,"mirror_url":null,"archived":false,"open_issues_count":0,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"forks":3,"open_issues":0,"watchers":2,"default_branch":"master","stargazers":2,"master_branch":"master"},"pusher":{"name":"ITHcc","email":"37447321+ITHcc@users.noreply.github.com"},"sender":{"login":"ITHcc","id":37447321,"node_id":"MDQ6VXNlcjM3NDQ3MzIx","avatar_url":"https://avatars2.githubusercontent.com/u/37447321?v=4","gravatar_id":"","url":"https://api.github.com/users/ITHcc","html_url":"https://github.com/ITHcc","followers_url":"https://api.github.com/users/ITHcc/followers","following_url":"https://api.github.com/users/ITHcc/following{/other_user}","gists_url":"https://api.github.com/users/ITHcc/gists{/gist_id}","starred_url":"https://api.github.com/users/ITHcc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ITHcc/subscriptions","organizations_url":"https://api.github.com/users/ITHcc/orgs","repos_url":"https://api.github.com/users/ITHcc/repos","events_url":"https://api.github.com/users/ITHcc/events{/privacy}","received_events_url":"https://api.github.com/users/ITHcc/received_events","type":"User","site_admin":false}}';
$data = "sha1=4b2333b8b4be99abb425d47bd5970f3492d3d8b5";
list($algo,$hash) = explode("=",$data);

var_dump($hash == hash_hmac($algo,$content,$key));


//在webhooks页面配置的秘钥
$key = "847404572a";

//接收Github发送给我们的数据
$contents = file_get_contents("php://input");
//将json转为数组
$data = json_decode($contents);

//获取请求通中的sha1签名
$signature = $_SERVER;
echo json_encode($signature);
die;
list($algo,$hash) = explode("=",$data);